<?php

namespace Tests\Unit\Http\Requests\Api;

use App\Http\Requests\Api\RegisterOpen;
use Tests\FormRequestTestCase;

class RegisterOpenTest extends FormRequestTestCase
{
    protected $requestClassName = RegisterOpen::class;

    const OPEN_DATA = [
        'data' => [
            'uuid' => 'test-uuid',
            'number' => 1234,
            'employee' => 'Test Employee',
            'cashAmount' => 12.34,
            'openedAt' => 1503410614, // 08/22/2017 @ 2:03pm (UTC)
        ],
    ];

    public function testValidateUUID()
    {
        $values = [null, '', ' ', 12];
        $this->assertValidates(self::OPEN_DATA, 'data.uuid', $values);
        $this->assertValidatesUniqueness(self::OPEN_DATA, 'data.uuid', 'registers', 'uuid');
    }

    public function testValidateNumber()
    {
        $values = [null, '', ' ', 'a', -1, 0];
        $this->assertValidates(self::OPEN_DATA, 'data.number', $values);
    }

    public function testValidateEmployee()
    {
        $values = [null, '', ' ', 12];
        $this->assertValidates(self::OPEN_DATA, 'data.employee', $values);
    }

    public function testValidateCashAmount()
    {
        $values = [null, '', -5];
        $this->assertValidates(self::OPEN_DATA, 'data.cashAmount', $values);
    }

    public function testValidateOpenedAt()
    {
        $values = [null, '', ' ', 0, -6];
        $this->assertValidates(self::OPEN_DATA, 'data.openedAt', $values, false);
    }

    public function testValidatesValidData()
    {
        $this->assertValidatesValidData(self::OPEN_DATA, ['data.openedAt']);
    }
}
